/*
@title: Mancala
@author: Lenochodik
@tags: ['strategy', 'classic', 'multiplayer', 'logic']
@addedOn: 2024-00-00
*/

const player = "p"
const storeUp = "1"
const storeDown = "2"
const half1 = "3"
const half2 = "4"
const nothing = "5"

const tile1 = "q"
const tile2 = "w"
const tile3 = "e"
const tile4 = "r"
const tile5 = "t"
const tile6 = "y"
const tile7 = "u"
const tile8 = "i"
const tile9 = "o"
const tile10 = "a"

setLegend(
  [player, bitmap`
C99C11111122CC9C
99C1LLLLLLLL2C99
C91LLLLLLLLLL2C9
C1LLLLLLLLLLLL1C
1LLLLLLLLLLLLLL1
1LLLLLL12LLLLLL2
1LLLLL1112LLLLL2
1LLLL111112LLLL1
1LLLL111112LLLL1
1LLLLL1111LLLLL1
1LLLLLL11LLLLLL1
1LLLLLLLLLLLLLL1
C1LLLLLLLLLLLL1C
9C1LLLLLLLLLL199
9CC1LLLLLLLL199C
999C11111111C9CC`],
  [storeUp, bitmap`
C9CC11111111C999
99C1LLLLLLLL2CC9
9C1LLLLLLLLLL2CC
91LLLLLLLLLLLL2C
1LLLLLLLLLLLLLL2
1LLLL111111LLLL2
1LLL11111111LLL2
1LL1111111111LL1
1LL1111111111LL1
1LL1111111111LL1
1LL1111111111LL1
1LL1111111111LL1
1LL1111111121LL1
1LL1111111111LL1
1LL1111111121LL1
1LL1111111121LL1`],
  [storeDown, bitmap`
1LL1111111121LL2
1LL1111111121LL1
1LL1111111121LL2
1LL1111111121LL2
1LL1111111121LL1
1LL1111111111LL1
1LL1111111121LL1
1LL1111111121LL1
1LL1111111211LL1
1LLL11112211LLL1
1LLLL111111LLLL1
1LLLLLLLLLLLLLL1
C1LLLLLLLLLLLL1C
9C1LLLLLLLLLL199
99C1LLLLLLLL1C9C
C9CC11111111C99C`],
  [half1, bitmap`
LLLLLLLLLLLLLLLL
1111111111111111
1111111111211222
999CCCCCCCCCCC99
CC99C999999999C9
CC99C99CCCCCC99C
C99CCCC999CCCC9C
99CCCCCCC9CCC99C
C99999CCCC9CC9C9
CCCCC9CCCC9C99C9
CCCCC99CCC9C9CC9
CC9999CCCC9CC9C9
99C9CCCCC9CCC9C9
99CCCCCC99CCC9CC
C9CCCC999CCC99CC
CC99999CCCC99CC9`],
  [half2, bitmap`
CC9CCCCCC999CC99
C9CC999C99C99CC9
C9C9CC9C9CCC9CC9
C999C99C9CC99CCC
CC9999CC9CC99CCC
CCC9CCCC99CC99CC
999CCC9CC99CC9CC
C9CC9999CC99C9CC
C9999CC9CCC9C99C
9999CC99CCC9CC9C
99C999CCCCC9CC99
C99999CCCC99CC99
CCCCC999999CCCCC
1111111111222121
1111111111111111
LLLLLLLLLLLLLLLL`],
  [nothing, bitmap`
99C99999999CCC99
C9CC99CCCC9C99CC
CCCCC99CCC9C9CCC
C9CCCC9CC9CC9CCC
C9C9999CC9CC9999
9CC9CCCCC9CCCCC9
CCC9CC9999999CCC
999999CC99C999CC
CC9CCCCCC99CC999
CC9CCC999C9CCC9C
C9999C9C99C999CC
CCCC9C9CC99CC99C
CC999C9CCC9CC99C
C99CCC9CCC9CC9CC
C9CCCC9CCC9999CC
CC99999CCCCCCCC9`],
  // Tiles
  [tile1, bitmap`
9C9C900999CC99C9
999C0220C99C9C9C
C99C0220CC99999C
CC99022000CC99CC
999C0220120C9999
99CC022012000CC9
C99902201201100C
000C0220L2012010
0110022L120L20L0
021L022222L120L0
002L021212222L20
C001L22121212220
9C0012222212120C
99C0122222222109
CC9C0L1111111L09
C9C90LLLLLLLL0C9`],
  [tile2, bitmap`
C99CFFFFFF66CC9C
99CFLLLLLLLL6C99
C9FLLLLLLLLLL6C9
CFLLLLLLLLLLLLFC
FLLLLLLLLLLLLLLF
FLLLLLLF6LLLLLL6
FLLLLLFFF6LLLLL6
FLLLLFFFFF6LLLLF
FLLLLFFFFF6LLLLF
FLLLLLFFFFLLLLLF
FLLLLLLFFLLLLLLF
FLLLLLLLLLLLLLLF
CFLLLLLLLLLLLLFC
9CFLLLLLLLLLLF99
9CCFLLLLLLLLF99C
999CFFFFFFFFC9CC`],
  [tile3, bitmap`
...........11111
.........1111111
.......1111LLLLL
......111LLLLLLL
.....11LLLLLLLLL
....11LLLLLLLLLL
...11LLLLLLLLLLL
..11LLLLLLLLLLLL
..1LLLLLLLLLLLLL
.11LLLLLLLLLLLLL
.1LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
1LLLLLLLLLLLLLLL
1LLLLLLLLLLLLLLL
1LLLLLLLLLLLLLLL
1LLLLLLLLLLLLLLL`],
  [tile4, bitmap`
11111...........
1111122.........
LLLLL2222.......
LLLLLLL221......
LLLLLLLLL11.....
LLLLLLLLLL21....
LLLLLLLLLLL11...
LLLLLLLLLLLL11..
LLLLLLLLLLLLL11.
LLLLLLLLLLLLL11.
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11`],
  [tile5, bitmap`
LLLLLLLLLLLLLLL1
LLLLLLLLLLLLLLL1
LLLLLLLLLLLLLLL1
LLLLLLLLLLLLLLL1
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLL11.
LLLLLLLLLLLLL11.
LLLLLLLLLLLL11..
LLLLLLLLLLL11...
LLLLLLLLLL11....
LLLLLLLLL11.....
LLLLLLL111......
LLLLL1111.......
1111111.........
11111...........`],
  [tile6, bitmap`
1LLLLLLLLLLLLLLL
1LLLLLLLLLLLLLLL
1LLLLLLLLLLLLLLL
1LLLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
.11LLLLLLLLLLLLL
.11LLLLLLLLLLLLL
..11LLLLLLLLLLLL
...11LLLLLLLLLLL
....11LLLLLLLLLL
.....11LLLLLLLLL
......111LLLLLLL
.......1111LLLLL
.........1111111
...........11111`],
  [tile7, bitmap`
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL
11LLLLLLLLLLLLLL`],
  [tile8, bitmap`
LLLLLLLLLLLLLL22
LLLLLLLLLLLLLL22
LLLLLLLLLLLLLL22
LLLLLLLLLLLLLL22
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL22
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11
LLLLLLLLLLLLLL11`],
  [tile9, bitmap`
....33333333....
...3333333333...
..333333333333..
.33333333333333.
3333333333333333
3333333333333333
3333333333333333
3333333333333333
3333333333333333
3333333333333333
3333333333333333
3333333333333333
.33333333333333.
..333333333333..
...3333333333...
....33333333....`],
  [tile10, bitmap`
................
................
................
................
................
................
................
................
................
................
................
................
................
................
................
................`],
)

setSolids([])

setPushables({
  [player]: []
})


let level = 0
const levels = [
  map`
................
................
..erererererer..
erytytytytytyter
ui444444444444ui
ui333333333333ui
ytererererereryt
..ytytytytytyt..
................
................`,
]
setMap(levels[level])

setBackground(nothing)


// = Base code ==================================================
const halfBoardSize = 6
const initialPieces = 5
const storesCount = 2
const storesIndexes = [halfBoardSize, 2 * halfBoardSize + 1]
const game = {
  board: Array(halfBoardSize * 2 + storesCount).fill(initialPieces),
  // board: Array.from({ length: halfBoardSize * 2 + storesCount }, (_, index) => index),
  currentPlayer: 0,
}

function printBoardText() {
  clearText()

  // Bottom half
  for (let i = 0; i < halfBoardSize; i++)
    addText(game.board[i].toString(), { x: 3 + i, y: 10, color: color`0` })

  // Top half
  for (let i = 0; i < halfBoardSize; i++)
    addText(game.board[halfBoardSize + 1 + i].toString(), { x: 14 - 2 * i, y: 3, color: color`0` })

  // Left store
  addText(game.board[storesIndexes[1]].toString(), { x: 2, y: 8, color: color`0` })

  // Right store
  addText(game.board[storesIndexes[0]].toString(), { x: 16, y: 8, color: color`0` })
}
printBoardText()
// ===============================================================

onInput("s", () => {
  getFirst(player).y += 1
})

afterInput(() => {

})
